  {{#extend "stylesheets"}}


<style>
  .aticle_post_container{
    width: 930px;
    padding: 20px;
    background: #fff;
    box-shadow: 1px 1px 3px #ddd;
    margin: 20px auto
  }

  #editor img{
    max-width:100%
  }

  .edui-dialog-image .edui-image-upload1{
    cursor:pointer
  }
  
</style>

<script>

 var URL ='/vendor/ueditor/';

 var GLOBAL={
  Domain:'{{Domain}}',
  uploadURL:'{{uploadURL}}'
 }

</script>

{{/extend}}

    <link href="/vendor/umeditor1_2_2-utf8-php/themes/default/css/umeditor.min.css" type="text/css" rel="stylesheet">
<div class="container">

<div class="aticle_post_container">
   <h1 align="center">发布图片故事</h1>
<hr>
  <p><input class="form-control input-lg" type="text" id="title" name="title" placeholder="标题" value="请输入文章标题" /></p>

    <p><textarea class="form-control input-lg" type="text" id="title" name="title" placeholder="标题" value="简介" /></textarea>
  <p><input class="form-control input-lg" type="text" id="title" name="title" placeholder="标题图" value="" /></p>



     <div style="width:900px;margin:20px auto 40px;">
        <script type="text/plain" id="editor" style="width:100%;height:660px;"></script>
    </div>

  <textarea style="position:absolute;left:-100%" id="content" class="form-control" name="content" id="" cols="30" rows="1">
    
  </textarea>


   
   <br/>
    

  <p align="center"><button class="btn btn-success btn-lg" id="Jsubmit" type="button"> 发 布 </button>
  </p>

</div>

</div>


  {{#extend "customerScript"}}



 <!-- 配置文件 -->

    <script type="text/javascript" src="/vendor/umeditor1_2_2-utf8-php/umeditor.config.js"></script>
    <!-- 编辑器源码文件 -->
    <script type="text/javascript" src="/vendor/umeditor1_2_2-utf8-php/umeditor.min.js"></script>
    <!-- 实例化编辑器 -->
    <script type="text/javascript">
  var um = UM.getEditor('editor', {
            imageUrl:GLOBAL.uploadURL,
            imagePath:GLOBAL.Domain,
            lang:/^zh/.test(navigator.language || navigator.browserLanguage || navigator.userLanguage) ? 'zh-cn' : 'en',
            langPath:UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
            focus: true
        });


    </script>

    <script src="http://cdn.staticfile.org/jquery-validate/1.14.0/jquery.validate.min.js"></script>


    <script>

var postAticle=function(){

    var postdata={
      title:$('#title').val(),
      content:um.getContent(),
    }

    if(postdata.title=='' || postdata.content.length<10){
      alert('标题不能为空，或内容字数太少')
      return 
    }

    $.post('/api/v1/createAticle',postdata,function(res) {
      if(res.error==0){
          alert('发布成功')
      }else{
        alert(res.msg)
      }
    })

}


    $('#Jsubmit').on('click',postAticle)


    


    </script>

{{/extend}}
