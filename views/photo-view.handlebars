
 <link rel="stylesheet" type="text/css" href="/vendor/sweetalert/sweetalert.css">

 <script src="/vendor/sweetalert/sweetalert.min.js"></script> 
<script>
  var PAGECONFIG={
      photoId:'{{photo.id}}',
      authorId:'{{photo.author_id}}'
  }
</script>

<style>
  .g-mainwraper {
    letter-spacing: -4px;
    margin: 0 auto;
    width: 100%;
    word-spacing: -0.43em;
}

.darkbg{
  background: #111
}
.price{
     font-size: 18px;
    font-weight: bold;
    line-height: 36px;
    color: #d6d6d6;
    vertical-align: middle;
}

.photo-header{
  background: #222;
  padding:10px 20px;
  color: #ccc;
  margin-top: 20px;
}

.photo-header h1{
  font-size: 20px;
  font-weight: bold;
  text-shadow:1px 1px 1px #000;

}

.photo-actions-section{
  background: #222;
  padding: 10px 20px;
  margin-top: 20px;
  color: #777
}
</style>

<div class="darkbg">

<div class="container">
<!-- <ol class="breadcrumb">
        <li><a href="/">主页</a><span class="divider"></span></li>
        <li><a href="/">图集</a><span class="divider"></span></li>

        <li class="active">详情</li>
        
      </ol> -->

      <!---->

<div class="container">
<div class="row">
<div class="col-md-8">
<section class="photo-details-section">
<div class="photo-header clearfix">
  
<h1 class="pull-left">{{photo.title}}</h1>
<p class="pull-right" id="J-picset-attention" class="picset-cmtnum">
        <b title="浏览量" class="w-ico-attention">点击数</b> <span id="J-picset-viewcount">2328</span>
        <b title="评论" class="w-ico-cmt f-ml20">评论数</b> <span id="J-picset-cmtcount">164</span>
        <b title="喜欢" class="w-ico-like f-ml20">喜欢数</b> <span id="J-picset-likecount">80</span>
      </p>
</div>

<div class="photo">
 <img width="100%" src="{{photo.pictures.[0]}}?imageView2/1/w/1180/" alt="{{photo.title}} ">


{{#each photo.pictures}}
 <img width="18%" src="{{this}}?imageView2/1/w/200/" alt="{{photo.title}} ">
{{/each}}

</div>
</section>
</div>
<div class="col-md-4">
<div class="photo-actions-section">
<div >图片简介：{{photo.discrib}} [{{photo.pictures.length}}张]</div>


<div class="cart-actions not-in-cart">

{{#if photo.price}}
<div class="price"> 售价：{{photo.price}}</div>
<button class="btn-buy btn btn-primary btn-block btn-lg">
立即购买
</button>

<p>已有<i class="red">183</i>人购买</p>
{{/if}}





<hr>
<h3>作者信息：</h3>
{{photo.author_id}}
<button>关注作者</button>

</div>

</div>

</div>

</div>
      <!---->



  <p align="center" ><i>浏览：1152次</i><i>时间：{{photo.update_at}} </i></p>

<!--未购买-->




  


  </div>

</div>

</div>

</div>


<script>

   var postdata={
    photoId:PAGECONFIG.photoId
   }



   $.post('/api/v1/getUserInfoById',{id:PAGECONFIG.authorId},function(data){

    console.log(data)

   })

  $.post('/api/v1/checkIsBuy',postdata,function (data) {
    console.log(data)
    if(data.errorno===0){
          $('.btn-buy').addClass('btn-success').text('已购买')

    }
  })
$('.btn-buy').on('click',function(){


  // $(this).attr('disabled',true).text('loading..')


  $.post('/api/v1/buyPhoto',postdata,function (data) {

          if(data.errorno==-1){
            swal({   title: data.msg,     type: "warning",   showCancelButton: true,   confirmButtonColor: "#DD6B55",   
              confirmButtonText: "立即登陆",   
              cancelButtonText: "下次再说",   
              closeOnConfirm: false }, function(){  
                location.href="/login" 
              });
          }
          else if(data.errorno==-2){

            swal({   title: data.msg,     type: "warning",   showCancelButton: true,   confirmButtonColor: "#DD6B55",   
              confirmButtonText: "立即充值",   
              cancelButtonText: "下次再说",   
              closeOnConfirm: false }, function(){  
                location.href="/score" 
              });

          }

          else if(data.errorno==-3){

            alert(data.msg);
           
          }
          else if(data.errorno==0){

              swal({ title: data.msg,     type: "success",   showCancelButton: false,   confirmButtonColor: "#DD6B55",   
              confirmButtonText: "确定",   
              closeOnConfirm: false }, function(){  
                location.href=location.href
              });

          }
  
      })
  


})


</script>